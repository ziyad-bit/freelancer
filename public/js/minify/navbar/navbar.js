(()=>{var e=document.getElementById("search"),t=document.getElementsByClassName("search_item"),n=document.querySelector(".navbar_list_search"),r=0,a=0;function o(t){var n=t.target.innerText;e.value=n,document.getElementById("search_form").submit()}document.onclick=function(e){if("search"!=e.target.id)for(var n=0;n<t.length;n++)t[n].style.display="none";"bell"!=e.target.id&&(u.style.display="none")},generalEventListener("click",".search_item",(function(e){o(e)})),generalEventListener("click",".search_name",(function(e){o(e)}));var i=document.querySelector("#recent_search_url").value;function c(){if(0==r)axios.get(i).then((function(e){if(200==e.status){if(1==a)for(var o=0;o<t.length;o++)t[o].style.display="none";a=1,r=1;var i=e.data.view;n.insertAdjacentHTML("afterbegin",i)}}));else{if(1==a)for(var e=0;e<t.length;e++)t[e].style.display="none";for(var o=document.getElementsByClassName("recent_search"),c=0;c<o.length;c++)o[c].style.display=""}}var l=[],s=document.querySelector("#search_url").value;e.addEventListener("input",debounce((function(){!function(){var r=e.value;if(""!=r){if(l.includes(r)){for(var o=0;o<t.length;o++)t[o].style.display="none";for(var i=document.getElementsByClassName("".concat(r)),u=0;u<i.length;u++)i[u].style.display="";return}l.unshift(r),axios.post(s,{search:r}).then((function(e){if(200==e.status){var r=e.data.view;if(1==a)for(var o=0;o<t.length;o++)t[o].style.display="none";a=1,n.insertAdjacentHTML("beforeend",r)}}))}else c()}()}))),e.onfocus=function(){""==e.value&&c()};var u=document.querySelector(".notif"),d=document.querySelector("#notifs_count"),f=document.querySelector("#auth_id").value,y=Number(d.textContent);Echo.private("App.Models.User.".concat(f)).notification((function(e){u.insertAdjacentHTML("afterbegin",e.view),y++,d.innerText=y,d.style.display=""})),document.querySelector(".fa-bell").onclick=function(){u.style.display="";var e=document.querySelector(".wrapper_notifs").getAttribute("data-update_url");y>0&&axios.put(e).then((function(e){200==e.status&&(d.style.display="none",y=0)}))},0!=y&&(d.style.display="");var m=!0;u.onscroll=function(){if(u.offsetHeight-2==u.scrollHeight-u.scrollTop&&1==m){var e=document.querySelector(".notif").lastElementChild.getAttribute("data-show_old_url");axios.get(e).then((function(e){if(200==e.status){var t=e.data.view;""!==t?u.insertAdjacentHTML("beforeend",t):m=!1}}))}},generalEventListener("click",".refuse_btn",(function(e){var t=e.target.parentElement.getAttribute("data-chat_room_id"),n=e.target.getAttribute("data-refuse_url");axios.post(n,{chat_room_id:t}).then((function(e){200==e.status&&document.querySelector(".notif_".concat(t)).remove()}))})),generalEventListener("click",".accept_btn",(function(){var e=document.querySelector("#accept_form"),t=document.querySelector('[name="_token"]');e.appendChild(t),e.submit()}))})();